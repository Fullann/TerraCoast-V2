# Terracoast - Application de Quiz GÃ©ographique

## 1. Introduction
Terracoast est une application ludique et interactive qui permet aux utilisateurs d'amÃ©liorer leurs connaissances en gÃ©ographie Ã  travers des quiz variÃ©s. Le jeu intÃ¨gre un systÃ¨me de progression, des duels entre joueurs et des classements mondiaux. Avec un design colorÃ© et une mascotte koala attachante, l'application vise Ã  rendre l'apprentissage amusant et stimulant.

## 2. FonctionnalitÃ©s ClÃ©s

### 2.1. Langues
- Multilingue (FranÃ§ais, Anglais, Espagnol, etc).
- Option de changement de langue dans le profil.
- Chargement dynamique des textes pour une personnalisation fluide.

### 2.2. Gestion de Profil
- **SystÃ¨me de niveaux** avec des titres visuels :
  - Cancre (bronze)
  - PÃ¨lerin (vert)
  - Rogue (rouge feu)
  - NoosphÃ¨re (violet)
  - Arcane (dorÃ©)
- **Badges** visibles sur les profils, attribuÃ©s selon les performances et l'anciennetÃ©.
- **Titres spÃ©ciaux** :
  - "Diligent" (1er d'un quiz spÃ©cifique).
  - "Ouroboros" (ancien compte).

### 2.3. CrÃ©ation de Profil
- Inscription avec :
  - Pseudo
  - Adresse email (pour newsletters et rÃ©cupÃ©ration de compte)
  - Mot de passe sÃ©curisÃ©
- Authentification via OAuth2 / JWT
- Validation des informations et rÃ©cupÃ©ration de mot de passe

### 2.4. CrÃ©ation de Quiz
- **Mode Admin** :
  - CrÃ©ation de quiz publics visibles par tous.
- **Mode Personnel** :
  - CrÃ©ation de quiz privÃ©s et partageable avec un lien unique.
- Interface intuitive pour ajouter questions, images et rÃ©ponses.

### 2.5. CompÃ©tition et Classements
- **Duel** :
  - Mode Quiz-Duel oÃ¹ deux joueurs rÃ©pondent aux mÃªmes questions en simultanÃ©.
  - Victoire basÃ©e sur rapiditÃ© et exactitude.
- **Classement** :
  - Affichage des scores mondiaux et par rÃ©gion.
  - Rangs visibles sur le profil.

### 2.6. Types de Quiz et RÃ©ponses
- Quiz basÃ©s sur :
  - Drapeaux par continent
  - Pays et leurs capitales
  - Cartes avec un pays colorÃ© et propositions de rÃ©ponse
  - Cartes vierges avec nom de pays
  - Mode type GeoGuessr (deviner un lieu Ã  partir d'une image)
  - Langue parlÃ©e dans le pays
  - Monnaie utilisÃ© dans le pays 
  - lieux mythique du pays
- **MÃ©thodes de rÃ©ponse** :
  - Choix multiple
  - Saisie manuelle
  - Clic sur une carte interactive
- Notation des quiz (1 Ã  5 Ã©toiles) aprÃ¨s la premiÃ¨re complÃ©tion.
- SystÃ¨me d'expÃ©rience (EXP) pour monter en niveau.

### 2.7. Design et ExpÃ©rience Utilisateur
- **Style graphique** inspirÃ© de Duolingo :
  - Couleurs vives et animations engageantes.
  - Mascotte Koala pour guider l'utilisateur.
- Interface fluide et accessible.

### 2.8. Soutien via Patreon
- PossibilitÃ© de soutenir le projet via Patreon.
- Avantages pour les contributeurs :
  - Badges exclusifs
  - Contenus supplÃ©mentaires
  - Personnalisation avancÃ©e du profil

## 3. SÃ©curitÃ© et Backend
- **SÃ©curitÃ©** :
  - Certificat SSL pour protÃ©ger les donnÃ©es.
  - Protection contre les bots (CAPTCHA, vÃ©rifications supplÃ©mentaires).
- **Backend** :
  - API REST/PostgresSQL pour gÃ©rer les utilisateurs et les quiz.
  - HÃ©bergement sur O2SWITCH.
- **Tests** :
  - Tests utilisateurs pour optimiser l'UX/UI.
  - Tests unitaires et d'intÃ©gration pour assurer la stabilitÃ©.

**Terracoast** a pour but de rendre l'apprentissage de la gÃ©ographie ludique et interactif tout en offrant un environnement compÃ©titif et engageant. ðŸš€

## 4. Technologies UtilisÃ©es

### **Frontend (Interface Utilisateur)**
#### **Framework & UI**
- **React.js** â€“ Pour le dÃ©veloppement web.  
- **React Native** (pour la future app mobile).  
- **Next.js** â€“ Pour le rendu cÃ´tÃ© serveur (SEO & performances).  
- **Tailwind CSS** â€“ Pour un design rapide et responsive.  
- **Shadcn/UI** â€“ Pour des composants modernes et accessibles.  
- **Framer Motion** â€“ Pour les animations fluides.  

#### **Gestion d'Ã©tat**
- **Zustand** ou **Redux Toolkit** â€“ Pour gÃ©rer l'Ã©tat global de l'application.  
- **React Query (TanStack Query)** â€“ Pour la gestion des requÃªtes API et cache.  

#### **Cartographie & GÃ©olocalisation**
- **Leaflet.js** ou **Mapbox** â€“ Pour les cartes interactives et modes de jeu type GeoGuessr.  
- **OpenStreetMap API** â€“ Pour rÃ©cupÃ©rer des donnÃ©es gÃ©ographiques.  

#### **Authentification & SÃ©curitÃ©**
- **NextAuth.js** â€“ Pour l'authentification OAuth, JWT et sÃ©curisation des sessions.  
- **bcrypt.js** â€“ Pour hacher les mots de passe.  

#### **Multilingue & AccessibilitÃ©**
- **react-i18next** â€“ Pour la gestion des traductions.  
- **Headless UI & Radix UI** â€“ Pour l'accessibilitÃ© et les composants UI interactifs.  


### **Backend (API & Base de DonnÃ©es)**
#### **Serveur & API**
- **Node.js** + **Express.js** â€“ Pour gÃ©rer les routes API et la logique mÃ©tier.  
- **tRPC** â€“ Pour un backend type API en TypeScript, avec autocomplÃ©tion.  
- **PostgreSQL** â€“ Base de donnÃ©es relationnelle robuste.  
- **Redis** â€“ Pour la mise en cache et le stockage des sessions.  

#### **SÃ©curitÃ© Backend**
- **Helmet.js** â€“ Pour sÃ©curiser l'API.  
- **Rate Limiting (express-rate-limit)** â€“ Pour Ã©viter le spam d'API.  
- **CSRF Protection** â€“ SÃ©curisation des requÃªtes.  

## 5. Structure de l'Application
npx tailwindcss init -p
### Architecture des Dossiers
```
Terracoast-V2/
â”œâ”€â”€ src/
â”‚ â”œâ”€â”€ app/ # Pages et routes Next.js
â”‚ â”œâ”€â”€ components/ # Composants React rÃ©utilisables
â”‚ â”‚ â”œâ”€â”€ ui/ # Composants UI de base
â”‚ â”‚ â”œâ”€â”€ forms/ # Composants de formulaires
â”‚ â”‚ â”œâ”€â”€ quiz/ # Composants spÃ©cifiques aux quiz
â”‚ â”‚ â””â”€â”€ maps/ # Composants de cartographie
â”‚ â”œâ”€â”€ hooks/ # Hooks React personnalisÃ©s
â”‚ â”œâ”€â”€ lib/ # Utilitaires et configurations
â”‚ â”œâ”€â”€ styles/ # Styles globaux et thÃ¨mes
â”‚ â”œâ”€â”€ types/ # Types TypeScript
â”‚ â”œâ”€â”€ utils/ # Fonctions utilitaires
â”‚ â””â”€â”€ services/ # Services (API, auth, etc.)
â”œâ”€â”€ public/ # Assets statiques
â”œâ”€â”€ prisma/ # SchÃ©mas et migrations Prisma
â”œâ”€â”€ tests/ # Tests unitaires et d'intÃ©gration
â””â”€â”€ locales/ # Fichiers de traduction
```
## 6. SchÃ©ma de la Base de DonnÃ©es

### Tables Principales

#### Users
```sql
CREATE TABLE users (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
username VARCHAR(50) UNIQUE NOT NULL,
email VARCHAR(255) UNIQUE NOT NULL,
password_hash VARCHAR(255) NOT NULL,
created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
last_login TIMESTAMP WITH TIME ZONE,
experience_points INTEGER DEFAULT 0,
level INTEGER DEFAULT 1,
is_admin BOOLEAN DEFAULT FALSE,
preferred_language VARCHAR(10) DEFAULT 'fr',
avatar_url TEXT,
is_premium BOOLEAN DEFAULT FALSE
);
```

#### Quizzes
```sql
CREATE TABLE quizzes (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
creator_id UUID REFERENCES users(id),
title JSONB NOT NULL, -- Pour le multilingue {fr: "titre", en: "title"}
description JSONB,
difficulty INTEGER CHECK (difficulty BETWEEN 1 AND 5),
category VARCHAR(50) NOT NULL,
is_public BOOLEAN DEFAULT TRUE,
created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
average_rating DECIMAL(3,2),
times_played INTEGER DEFAULT 0
);
```

#### Questions
```sql
CREATE TABLE questions (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
quiz_id UUID REFERENCES quizzes(id) ON DELETE CASCADE,
question_text JSONB NOT NULL,
question_type VARCHAR(50) NOT NULL, -- multiple_choice, text_input, map_click
media_url TEXT,
points INTEGER DEFAULT 10,
time_limit INTEGER, -- en secondes
created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
```

#### RÃ©ponses
```sql
CREATE TABLE answers (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
question_id UUID REFERENCES questions(id) ON DELETE CASCADE,
answer_text JSONB NOT NULL,
is_correct BOOLEAN NOT NULL,
explanation JSONB
);
```
#### UserProgress
```sql
CREATE TABLE user_progress (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
user_id UUID REFERENCES users(id),
quiz_id UUID REFERENCES quizzes(id),
score INTEGER NOT NULL,
completion_time INTEGER, -- en secondes
completed_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
answers_data JSONB -- stockage des rÃ©ponses dÃ©taillÃ©es
);
```
#### Badges
```ql
CREATE TABLE badges (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
name JSONB NOT NULL,
description JSONB NOT NULL,
icon_url TEXT NOT NULL,
requirement_type VARCHAR(50),
requirement_value INTEGER
);
```
#### UserBadges
```sql
sql
CREATE TABLE user_badges (
user_id UUID REFERENCES users(id),
badge_id UUID REFERENCES badges(id),
earned_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (user_id, badge_id)
);
```
#### Duels
```sql
CREATE TABLE duels (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
quiz_id UUID REFERENCES quizzes(id),
player1_id UUID REFERENCES users(id),
player2_id UUID REFERENCES users(id),
player1_score INTEGER DEFAULT 0,
player2_score INTEGER DEFAULT 0,
status VARCHAR(20) DEFAULT 'pending', -- pending, active, completed
created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
completed_at TIMESTAMP WITH TIME ZONE
);
```
#### QuizRatings
```sql
CREATE TABLE quiz_ratings (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
user_id UUID REFERENCES users(id),
quiz_id UUID REFERENCES quizzes(id),
rating INTEGER CHECK (rating BETWEEN 1 AND 5),
comment TEXT,
created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
UNIQUE(user_id, quiz_id)
);
```
### Tables de Support

#### UserSettings
```sql
CREATE TABLE user_settings (
user_id UUID PRIMARY KEY REFERENCES users(id),
notification_preferences JSONB,
ui_preferences JSONB,
privacy_settings JSONB
);
```
#### QuizCategories
```sql
CREATE TABLE quiz_categories (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
name JSONB NOT NULL,
description JSONB,
icon_url TEXT
);
```
#### Achievements
```sql
CREATE TABLE achievements (
id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
name JSONB NOT NULL,
description JSONB NOT NULL,
requirement_type VARCHAR(50),
requirement_value INTEGER,
icon_url TEXT
);
```
#### UserAchievements
```sql
CREATE TABLE user_achievements (
user_id UUID REFERENCES users(id),
achievement_id UUID REFERENCES achievements(id),
earned_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (user_id, achievement_id)
);
```
### Index et Optimisations
```sql
-- Index pour amÃ©liorer les performances des requÃªtes frÃ©quentes
CREATE INDEX idx_quiz_category ON quizzes(category);
CREATE INDEX idx_user_progress_user ON user_progress(user_id);
CREATE INDEX idx_user_progress_quiz ON user_progress(quiz_id);
CREATE INDEX idx_questions_quiz ON questions(quiz_id);
CREATE INDEX idx_answers_question ON answers(question_id);
CREATE INDEX idx_duels_players ON duels(player1_id, player2_id);
-- Trigger pour mettre Ã  jour updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
NEW.updated_at = CURRENT_TIMESTAMP;
RETURN NEW;
END;
$$ language 'plpgsql';
CREATE TRIGGER update_user_updated_at
BEFORE UPDATE ON users
FOR EACH ROW
EXECUTE FUNCTION update_updated_at_column();
CREATE TRIGGER update_quiz_updated_at
BEFORE UPDATE ON quizzes
FOR EACH ROW
EXECUTE FUNCTION update_updated_at_column();
```
